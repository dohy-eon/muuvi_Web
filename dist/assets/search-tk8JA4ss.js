const o="https://api.themoviedb.org/3",_="https://image.tmdb.org/t/p";function h(t,e="w342"){if(t)return`${_}/${e}${t}`}async function d(t){const e="69a6ef89f280454b2aab653333314c3d",s=new URL(`${o}/search/multi`);s.searchParams.set("query",t),s.searchParams.set("include_adult","false"),s.searchParams.set("language","ko-KR"),s.searchParams.set("page","1");const n=await fetch(s.toString(),{headers:{Authorization:`Bearer ${e.startsWith("eyJ")?e:""}`,"Content-Type":"application/json;charset=utf-8"}});if(n.status===401){const r=new URL(`${o}/search/multi`);r.searchParams.set("api_key",e),r.searchParams.set("query",t),r.searchParams.set("include_adult","false"),r.searchParams.set("language","ko-KR"),r.searchParams.set("page","1");const i=await(await fetch(r.toString())).json();return u((i==null?void 0:i.results)??[])}const a=await n.json();return u((a==null?void 0:a.results)??[])}function u(t){return t.filter(e=>e.media_type==="movie"||e.media_type==="tv").map(e=>{const s=e.title||e.name||"",n=e.release_date||e.first_air_date||"",a=n?n.slice(0,4):void 0,r=e.poster_path||e.profile_path||null;return{id:String(e.id),title:s,year:a,posterUrl:h(r,"w342"),mediaType:e.media_type??"movie"}})}async function f(t,e){const s="69a6ef89f280454b2aab653333314c3d",n=t==="movie"?`/movie/${e}`:`/tv/${e}`,a=new URL(`${o}${n}`);a.searchParams.set("language","ko-KR"),a.searchParams.set("append_to_response","credits,release_dates,content_ratings");const r=await fetch(a.toString(),{headers:{Authorization:`Bearer ${s.startsWith("eyJ")?s:""}`,"Content-Type":"application/json;charset=utf-8"}});if(r.status===401){const i=new URL(`${o}${n}`);i.searchParams.set("api_key",s),i.searchParams.set("language","ko-KR"),i.searchParams.set("append_to_response","credits,release_dates,content_ratings");const p=await fetch(i.toString());if(!p.ok)return null;const m=await p.json();return l(t,m)}if(!r.ok)return null;const c=await r.json();return l(t,c)}function g(t,e="w500"){return h(t??void 0,e)}function l(t,e){return t==="movie"?{mediaType:"movie",id:e.id,title:e.title,release_date:e.release_date,overview:e.overview,poster_path:e.poster_path,backdrop_path:e.backdrop_path,runtime:e.runtime,genres:e.genres}:{mediaType:"tv",id:e.id,name:e.name,first_air_date:e.first_air_date,overview:e.overview,poster_path:e.poster_path,backdrop_path:e.backdrop_path,episode_run_time:e.episode_run_time,genres:e.genres}}export{g as b,f as g,d as s};
