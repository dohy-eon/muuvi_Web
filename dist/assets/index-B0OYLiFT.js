import{j as e}from"./index-isNbCbEh.js";import{u as k,a as t}from"./react-vendor-BCvJ4SZV.js";import{B as C}from"./BottomNavigation-BaosoDGv.js";import{s as S}from"./search-tk8JA4ss.js";import"./supabase-vendor-DMkEyeru.js";import"./recoil-vendor-DrCo3c3K.js";const g="muuvi_recent_searches_v1";function I(){const m=k(),[l,r]=t.useState(""),[N,p]=t.useState(!1),[c,u]=t.useState(!1),[i,d]=t.useState([]),[x,j]=t.useState(!1),[f,o]=t.useState([]),v=t.useRef(null);t.useEffect(()=>{const s=localStorage.getItem(g);if(s)try{const a=JSON.parse(s);Array.isArray(a)&&d(a.slice(0,10))}catch{}},[]),t.useEffect(()=>{localStorage.setItem(g,JSON.stringify(i.slice(0,10)))},[i]);const w=t.useMemo(()=>["태풍상사","피지컬: 아시아","환승연애","위키드","제4차 사랑혁명"],[]),h=s=>{const a=(s??l).trim();a&&(j(!0),d(n=>[a,...n.filter(y=>y!==a)].slice(0,10)),o([]),(async()=>{try{const n=await S(a);o(n)}catch(n){console.error("TMDB 검색 실패:",n),o([])}finally{j(!1)}})())},b=!l&&!c;return e.jsxs("div",{className:"w-full h-screen bg-white relative font-pretendard overflow-hidden overflow-x-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 z-20 bg-white",children:e.jsxs("div",{className:"px-4 pt-3 pb-2 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>m(-1),"aria-label":"뒤로가기",className:"shrink-0 flex items-center justify-center",children:e.jsx("svg",{width:"28",height:"28",viewBox:"0 0 28 28",fill:"none",className:"transform -translate-x-0.5",children:e.jsx("path",{d:"M16 8L10 14L16 20",stroke:"#2e2c6a",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})})}),e.jsxs("div",{className:`flex-1 h-11 rounded-[14px] px-3 flex items-center gap-2 transition-all ${c?"bg-white border-2 border-[#2e2c6a]":"bg-[#f0f2f4] border-2 border-transparent"}`,children:[!c&&!l&&e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",className:"shrink-0",children:[e.jsx("circle",{cx:"9",cy:"9",r:"7",stroke:"#60646C",strokeWidth:"1.5"}),e.jsx("path",{d:"M14 14L18 18",stroke:"#60646C",strokeWidth:"1.5",strokeLinecap:"round"})]}),e.jsx("input",{ref:v,className:"flex-1 h-full bg-transparent outline-none text-[15px] placeholder:text-[#9aa0a6]",placeholder:"작품 이름으로 검색",value:l,onChange:s=>r(s.target.value),onFocus:()=>u(!0),onBlur:()=>u(!1),onCompositionStart:()=>p(!0),onCompositionEnd:()=>p(!1),onKeyDown:s=>{s.key==="Enter"&&!N&&(s.preventDefault(),h())}}),!c&&l&&e.jsx("button",{onClick:()=>{var s;r(""),o([]),(s=v.current)==null||s.focus()},"aria-label":"지우기",className:"shrink-0 w-8 h-8 rounded-full bg-black/5 flex items-center justify-center",children:e.jsx("span",{className:"text-[#60646C] text-sm",children:"✕"})})]})]})}),e.jsx("div",{className:"h-full overflow-y-auto overflow-x-hidden bg-white pt-[68px] pb-24 relative",children:e.jsxs("div",{className:"px-4",children:[b&&e.jsxs("div",{className:"space-y-8",children:[!!i.length&&e.jsxs("section",{children:[e.jsx("h3",{className:"text-[15px] font-semibold text-[#2e2c6a] mb-3",children:"최근 검색"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(s=>e.jsx("button",{onClick:()=>{r(s),h(s)},className:"px-3 h-8 rounded-full bg-[#f0f2f4] text-[13px] text-[#2e2c6a] hover:bg-[#e7e9ec]",children:s},s))}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:()=>d([]),className:"text-[12px] text-[#60646C] underline",children:"모두 지우기"})})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-[15px] font-semibold text-[#2e2c6a] mb-3",children:"인기 검색어"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(s=>e.jsx("button",{onClick:()=>{r(s),h(s)},className:"px-3 h-8 rounded-full bg-[#2e2c6a]/10 text-[13px] text-[#2e2c6a] hover:bg-[#2e2c6a]/15",children:s},s))})]})]}),x&&e.jsx("div",{className:"mt-2 space-y-4",children:Array.from({length:6}).map((s,a)=>e.jsxs("div",{className:"flex gap-3 animate-pulse",children:[e.jsx("div",{className:"w-20 h-28 rounded-[8px] bg-[#f0f2f4]"}),e.jsxs("div",{className:"flex-1 py-1",children:[e.jsx("div",{className:"h-4 w-2/3 bg-[#f0f2f4] rounded mb-2"}),e.jsx("div",{className:"h-3 w-1/3 bg-[#f0f2f4] rounded mb-3"}),e.jsx("div",{className:"h-3 w-1/2 bg-[#f0f2f4] rounded"})]})]},a))}),!x&&!!f.length&&e.jsx("div",{className:"mt-2 space-y-4",children:f.map(s=>e.jsxs("button",{onClick:()=>m(`/content/tmdb/${s.mediaType}/${s.id}`),className:"w-full flex gap-3",children:[e.jsx("div",{className:"w-20 h-28 rounded-[8px] bg-[#e7e9ec] overflow-hidden",children:s.posterUrl?e.jsx("img",{src:s.posterUrl,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-[#d8dbe0] to-[#f0f2f4]"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-[15px] font-semibold text-[#111827] line-clamp-2",children:s.title}),e.jsx("p",{className:"text-[12px] text-[#6b7280] mt-1",children:s.year??""})]})]},s.id))}),!x&&l&&f.length===0&&!b&&e.jsx("div",{className:"mt-12 text-center",children:e.jsx("p",{className:"text-[#60646C]",children:"검색 결과가 없어요"})})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-30 pt-4 pb-2 pointer-events-none",children:e.jsx("div",{className:"pointer-events-auto",children:e.jsx(C,{})})})]})}export{I as default};
